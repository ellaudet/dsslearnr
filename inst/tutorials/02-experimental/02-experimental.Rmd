---
title: "DSS PRACTICE EXERCISES: CHAPTER 2"
output:
  learnr::tutorial:
    progressive: true
    ace_theme: github
    theme: spacelab
runtime: shiny_prerendered
description: "Practice Exercises for Readers of Data Analysis for Social Science."
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
#library(gradethis)
#tutorial_options(exercise.checker = gradethis::grade_learnr)
#tut_reptitle <- "DSS: Output Report"
```

```{js target-blank, echo=FALSE}
$(document).ready(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
});
```

<style>

table, td, th {
  border: 1px solid lightgray;
}

table {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 20px;
  margin-top: 15px;
}

td { text-align: center;}
th { text-align: center;}
th, td { padding: 15px; }
</style>


## <span style=color:dodgerblue> Welcome and Instructions

<img src="/images/dss.png" 
     width="200" 
     height="250" />

This is a tutorial for readers of DSS, which stands for [Elena Llaudet and Kosuke Imai's *Data Analysis for Social Science: A Friendly and Practical Introduction* (Princeton University Press, 2022)](https://press.princeton.edu/books/paperback/9780691199436/data-analysis-for-social-science). 

DSS teaches from scratch R, statistics, and the fundamentals of quantitative social science (that is, the fundamentals of causal inference, survey research, and predictive models). The practice exercises you will find here cover all of these and are organized by chapter of the book.

Each chapter is divided into three to five topics, and each topic corresponds to one to five sections of the textbook. In other words, each topic reviews only a handful of pages of the textbook, which often can be read in a single seating. Here is the recommended sequence: 

<body>
<table>
  <tr>
    <th><span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$ <span style=color:steelblue> STEP 1  <span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$ </span></th>
    <th><span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$  <span style=color:steelblue> STEP 2  <span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$ </span></th>
    <th> <span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$  <span style=color:steelblue> STEP 3 <span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$</span></th>
    <th> <span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$  <span style=color:steelblue> STEP 4 <span style=color:lightgray> $\blacktriangleright$$\blacktriangleright$$\blacktriangleright$</span></th>
  </tr>
  <tr>
    <td> read the section(s) <br> of the textbook <br> that correspond to <br> a particular topic </td>
    <td> follow along <br> with the exercises <br>in the textbook <br>on your own computer</td>
    <td> complete <br> the corresponding <br> practice exercises <br>provided here </td>
    <td> move on <br> to the next topic, <br> and go back <br> to step 1 </td>
  </tr>
</table>
  
Note that the practice exercises are designed to be completed *after* having done the corresponding readings of the book and *after* having followed the exercises in the book with your own computer. They are not meant to be a substitute for the book, but rather a supplement. 

Any errors found in these practice exercises are my own. If you find any, I would really appreciate it if you could let me know by sending me an email at [ellaudet@gmail.com](ellaudet@gmail.com). Thank you! *I hope these practice exercises are helpful to you and/or your students!* - Elena


## <span style=color:dodgerblue> CHAPTER 2 OVERVIEW
In chapter 2, we learn what causal effects are and how to estimate them using randomized experiments. 

The practice exercises for this chapter are organized into two topics. In the Table below, you can see (1) the topics, (2) the section(s) of the book that correspond to each topic, (3) the key concepts and mathematical notation discussed, and (4) the R functions and R operators reviewed.

</head>
<body>
<table>
  <tr>
    <th> Topic </th>
    <th> Readings </th>
    <th> Key Concepts and Notation </th>
    <th> R Functions and Operators </th>
  </tr>
  <tr>
    <td> Estimating Causal Effects with Randomized Experiments </td>
    <td>2-2.4</td>
    <td>  causal relationships, treatment (X) vs. outcome variables (Y), potential outcomes, factual vs. counterfactual outcomes, fundamental problem of causal inference, individual vs. average causal effects, randomized experiments, random treatment assignment, treatment and control groups, pre-treatment characteristics, the difference-in-means estimator</td>
    <td> </td>
  </tr>
  <tr>
    <td> Computing the difference-in-means estimator </td>
    <td> 2.5-2.7 </td>
    <td> </td>
    <td> ==, ifelse(), [] </td>
  </tr>
</table>

At the end, there is an interactive graph to help you develop an intuition for why random treatment assignment makes treatment and control groups comparable when the sample size is large enough. Make sure to take some time to play with it.

Let's start! <br>

## <span style=color:dodgerblue> Estimating Causal Effects <br> with Randomized Experiments
Complete the following practice exercises *after* reading Sections 2 through 2.4 of DSS, including both, and *after* having followed the exercises in the book with your own computer.

## <span style=color:dodgerblue> Computing the Difference-in-Means Estimator

## <span style=color:dodgerblue> Interactive Graph: <br> Random Treatment Assignment

<body>
<table>
  <tr>
    <th> <span style=color:steelblue> 
**Random treatment assignment <br> makes treatment and control groups comparable<br> when the sample size is large enough.**
</span></th>
  </tr>
</table>


Explanation: Suppose there were only five types of individuals in the world: orange, blue, pink, green, and purple. If we were to assign individuals to two different groups--the treatment group and the control group--at random (that is, through a random process such as the flip of a coin), the two groups would contain similar proportions of each type of individual as long as the sample size is large enough. 

Let's examine this further:

1. When the sample size is very small, the two groups will likely be different because the sample size is simply too small to create two groups with similar compositions. For example, as shown below, when the sample size is of 20 individuals (4 orange, 2 blue, 4 pink, 6 green, and 4 purple), the treatment group could end up with all the pink individuals and the control group could end up with all the blue individuals, making the two groups clearly not comparable even though the groups were created at random.

2. Now, move the slide to increase the sample size, and observe how the composition of the treatment and control groups start to approximate each other as a result. (Once you let go of the slide, R will assign the number of individuals that you have chosen to the two groups at random, and reproduce the histograms showing you the results.)<br><br> For example, if you set the sample size to 300, the two groups become quite similar. They are now both composed of roughly 20% orange individuals, 10% blue individuals, 20% pink individuals, 30% green individuals, and 20% purple individuals. This is because by assigning individuals to the two groups at random, about half of the individuals from each type end up in the treatment group, and the other half end up in the control group.
            
This explains why in randomized experiments, in which, by definition, we assign individuals to treatment and control groups at random, the two groups should be comparable, that is, have similar proportions of pre-treatment characteristics, if the sample size is large enough.
            
```{r, echo=FALSE}
headerPanel("") # to add blank space before input
sliderInput(inputId = "sample_size", label = "Sample Size (n)", min = 20, max = 300, value = 20)
headerPanel("") # to add blank space before graph
plotOutput("distPlot1")
headerPanel("") # to add blank space after graph
headerPanel("") # to add blank space after graph
helpText("Note: The histrograms show the number of individuals from each type that are in (a) the full sample, (b) the treatment group, and (c) the control group.
      (While n stands for the total number of individuals in the sample, n_treatment stands for the total number of individuals in the treatment group,
      and n_control stands for the total number of individuals in the control group.)", style = "color:gray")
headerPanel("") # to add blank space after note
```

```{r, context="server"}            
output$distPlot1 <- renderPlot({
                  n <- input$sample_size
                  volunteers <- c(rep(0, n * 0.2), rep(2, n * 0.1), rep(3, n * 0.2), rep(4, n * 0.3), rep(5, n * 0.2))
                  set.seed(678)
                  treated <- sample(c(0, 1), size = length(volunteers), replace = TRUE, prob = c(0.5, 0.5))
                  data <- data.frame(volunteers, treated)
                  my_colors <- c("#fc8d62", "#9fafd3","#e78ac3", "#66c2a5", "#9895ae")
                  par(mfrow = c(1, 3), cex = 1, mar = c(1, 5, 3, 2))
                  hist(data$volunteers,
                        breaks = 6, main = "",
                        xlab = "", col = my_colors, ylim = c(0, n / 3 + 0.10 * n), axes = F, border = "white"
                  )
                  mtext("Full Sample",
                        side = 3, line = 1.5, outer = FALSE, adj = 0.5, cex = 1.2, font = 2
                  )
                  mtext(paste("(n = ", length(data$volunteers), ")", sep = ""),
                        side = 3, line = 0, outer = FALSE, adj = 0.5, cex = 1.1, font = 1
                  )
                  axis(2, col = "gray17", col.ticks = "gray", col.axis = "gray17", tck = -0.05)
                  hist(data$volunteers[data$treated == 1],
                        breaks = 6,
                        main = "", xlab = "", col = my_colors, ylim = c(0, n / 3 + 0.10 * n), axes = F, border = "white"
                  )
                  mtext("Treatment Group",
                        side = 3, line = 1.5, outer = FALSE, adj = 0.5, cex = 1.2, font = 2
                  )
                  mtext(paste("(n_treatment = ", length(data$volunteers[data$treated == 1]), ")", sep = ""),
                        side = 3, line = 0, outer = FALSE, adj = 0.5, cex = 1.1, font = 1
                  )
                  axis(2, col = "gray17", col.ticks = "gray", col.axis = "gray17", tck = -0.05)
                  hist(data$volunteers[data$treated == 0],
                        breaks = 6, main = "",
                        xlab = "", col = my_colors, ylim = c(0, n / 3 + 0.10 * n), axes = F, border = "white"
                  )
                  mtext("Control Group",
                        side = 3, line = 1.5, outer = FALSE, adj = 0.5, cex = 1.2, font = 2
                  )
                  mtext(paste("(n_control = ", length(data$volunteers[data$treated == 0]), ")", sep = ""),
                        side = 3, line = 0, outer = FALSE, adj = 0.5, cex = 1.1, font = 1
                  )
                  axis(2, col = "gray17", col.ticks = "gray", col.axis = "gray17", tck = -0.05)
            })
```
